Importing candle utils for keras
Configuration file:  /gpfs/mira-home/apeck/Modified_Benchmarks/Pilot1/P1B2/p1b2_default_model.txt
{'activation': 'sigmoid',
 'batch_size': 60,
 'data_url': 'http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/P1B2/',
 'dense': [1024, 512, 256],
 'drop': 0.0,
 'epochs': 1,
 'feature_subsample': 0,
 'initialization': 'glorot_uniform',
 'learning_rate': 0.001,
 'loss': 'categorical_crossentropy',
 'optimizer': 'rmsprop',
 'penalty': 1e-05,
 'rng_seed': 2017,
 'save_path': 'save',
 'scaling': 'minmax',
 'shuffle': True,
 'test_data': 'P1B2.test.csv',
 'train_data': 'P1B2.train.csv',
 'validation_split': 0.1}
Params:
{'activation': 'sigmoid',
 'batch_size': 60,
 'data_url': 'http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/P1B2/',
 'datatype': <class 'numpy.float32'>,
 'dense': [1024, 512, 256],
 'drop': 0.0,
 'epochs': 1,
 'experiment_id': 'EXP000',
 'feature_subsample': 0,
 'gpus': [],
 'initialization': 'glorot_uniform',
 'learning_rate': 0.001,
 'logfile': None,
 'loss': 'categorical_crossentropy',
 'optimizer': 'rmsprop',
 'output_dir': '/gpfs/mira-home/apeck/CANDLE_testing/avery_modified_results/run2/Output/EXP000/RUN000',
 'penalty': 1e-05,
 'rng_seed': 2017,
 'run_id': 'RUN000',
 'save_path': 'save',
 'scaling': 'minmax',
 'shuffle': False,
 'test_data': 'P1B2.test.csv',
 'timeout': -1,
 'train_bool': True,
 'train_data': 'P1B2.train.csv',
 'validation_split': 0.1,
 'verbose': None}
Shape X_train:  (2700, 28204)
Shape X_val:  (300, 28204)
Shape X_test:  (1000, 28204)
Shape y_train:  (2700, 10)
Shape y_val:  (300, 10)
Shape y_test:  (1000, 10)
Range X_train --> Min:  0.0 , max:  1.0
Range X_val --> Min:  0.0 , max:  1.0
Range X_test --> Min:  0.0 , max:  1.0
Range y_train --> Min:  0 , max:  1
Range y_val --> Min:  0 , max:  1
Range y_test --> Min:  0 , max:  1
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 28204)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 1024)              28881920  
_________________________________________________________________
dense_2 (Dense)              (None, 512)               524800    
_________________________________________________________________
dense_3 (Dense)              (None, 256)               131328    
_________________________________________________________________
dense_4 (Dense)              (None, 10)                2570      
=================================================================
Total params: 29,540,618
Trainable params: 29,540,618
Non-trainable params: 0
_________________________________________________________________
Train on 2700 samples, validate on 300 samples
Epoch 1/1

  60/2700 [..............................] - ETA: 1:04 - loss: 2.6060 - acc: 0.1000
 120/2700 [>.............................] - ETA: 33s - loss: 2.6039 - acc: 0.1167 
 180/2700 [=>............................] - ETA: 22s - loss: 2.5908 - acc: 0.1222
 240/2700 [=>............................] - ETA: 17s - loss: 2.5536 - acc: 0.1208
 300/2700 [==>...........................] - ETA: 14s - loss: 2.5257 - acc: 0.1267
 360/2700 [===>..........................] - ETA: 12s - loss: 2.5135 - acc: 0.1111
 420/2700 [===>..........................] - ETA: 10s - loss: 2.4998 - acc: 0.1167
 480/2700 [====>.........................] - ETA: 9s - loss: 2.4877 - acc: 0.1229 
 540/2700 [=====>........................] - ETA: 8s - loss: 2.4794 - acc: 0.1185
 600/2700 [=====>........................] - ETA: 7s - loss: 2.4709 - acc: 0.1133
 660/2700 [======>.......................] - ETA: 7s - loss: 2.4630 - acc: 0.1152
 720/2700 [=======>......................] - ETA: 6s - loss: 2.4560 - acc: 0.1208
 780/2700 [=======>......................] - ETA: 6s - loss: 2.4471 - acc: 0.1218
 840/2700 [========>.....................] - ETA: 5s - loss: 2.4444 - acc: 0.1179
 900/2700 [=========>....................] - ETA: 5s - loss: 2.4373 - acc: 0.1178
 960/2700 [=========>....................] - ETA: 4s - loss: 2.4331 - acc: 0.1188
1020/2700 [==========>...................] - ETA: 4s - loss: 2.4284 - acc: 0.1206
1080/2700 [===========>..................] - ETA: 4s - loss: 2.4216 - acc: 0.1241
1140/2700 [===========>..................] - ETA: 4s - loss: 2.4192 - acc: 0.1211
1200/2700 [============>.................] - ETA: 3s - loss: 2.4129 - acc: 0.1250
1260/2700 [=============>................] - ETA: 3s - loss: 2.4086 - acc: 0.1214
1320/2700 [=============>................] - ETA: 3s - loss: 2.4037 - acc: 0.1258
1380/2700 [==============>...............] - ETA: 3s - loss: 2.3997 - acc: 0.1268
1440/2700 [===============>..............] - ETA: 2s - loss: 2.3976 - acc: 0.1278
1500/2700 [===============>..............] - ETA: 2s - loss: 2.3938 - acc: 0.1307
1560/2700 [================>.............] - ETA: 2s - loss: 2.3892 - acc: 0.1359
1620/2700 [=================>............] - ETA: 2s - loss: 2.3856 - acc: 0.1358
1680/2700 [=================>............] - ETA: 2s - loss: 2.3821 - acc: 0.1363
1740/2700 [==================>...........] - ETA: 2s - loss: 2.3765 - acc: 0.1385
1800/2700 [===================>..........] - ETA: 1s - loss: 2.3731 - acc: 0.1394
1860/2700 [===================>..........] - ETA: 1s - loss: 2.3685 - acc: 0.1419
1920/2700 [====================>.........] - ETA: 1s - loss: 2.3633 - acc: 0.1422
1980/2700 [=====================>........] - ETA: 1s - loss: 2.3590 - acc: 0.1455
2040/2700 [=====================>........] - ETA: 1s - loss: 2.3538 - acc: 0.1505
2100/2700 [======================>.......] - ETA: 1s - loss: 2.3536 - acc: 0.1495
2160/2700 [=======================>......] - ETA: 1s - loss: 2.3471 - acc: 0.1537
2220/2700 [=======================>......] - ETA: 0s - loss: 2.3435 - acc: 0.1532
2280/2700 [========================>.....] - ETA: 0s - loss: 2.3394 - acc: 0.1557
2340/2700 [=========================>....] - ETA: 0s - loss: 2.3354 - acc: 0.1594
2400/2700 [=========================>....] - ETA: 0s - loss: 2.3345 - acc: 0.1596
2460/2700 [==========================>...] - ETA: 0s - loss: 2.3318 - acc: 0.1581
2520/2700 [===========================>..] - ETA: 0s - loss: 2.3285 - acc: 0.1603
2580/2700 [===========================>..] - ETA: 0s - loss: 2.3235 - acc: 0.1612
2640/2700 [============================>.] - ETA: 0s - loss: 2.3196 - acc: 0.1625
2700/2700 [==============================] - 6s 2ms/step - loss: 2.3163 - acc: 0.1637 - val_loss: 6.0741 - val_acc: 0.0000e+00
Evaluation on test data: {'accuracy': 0.189}
